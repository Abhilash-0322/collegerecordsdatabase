// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Student {
  studentId   Int          @id @default(autoincrement()) @map("student_id")
  name        String       @db.VarChar(100)
  dob         DateTime     @db.Date
  department  String       @db.VarChar(100)
  gender      String       @db.VarChar(10)
  phone       String       @db.VarChar(15)
  email       String       @unique @db.VarChar(100)
  createdAt   DateTime     @default(now()) @map("created_at")
  updatedAt   DateTime     @updatedAt @map("updated_at")
  
  enrollments Enrollment[]

  @@map("students")
}

model Faculty {
  facultyId   Int        @id @default(autoincrement()) @map("faculty_id")
  name        String     @db.VarChar(100)
  department  String     @db.VarChar(100)
  designation String     @db.VarChar(50)
  phone       String     @db.VarChar(15)
  email       String     @unique @db.VarChar(100)
  createdAt   DateTime   @default(now()) @map("created_at")
  updatedAt   DateTime   @updatedAt @map("updated_at")
  
  teachings   Teaching[]

  @@map("faculty")
}

model Course {
  courseId    Int          @id @default(autoincrement()) @map("course_id")
  courseName  String       @map("course_name") @db.VarChar(100)
  department  String       @db.VarChar(100)
  credit      Int
  createdAt   DateTime     @default(now()) @map("created_at")
  updatedAt   DateTime     @updatedAt @map("updated_at")
  
  enrollments Enrollment[]
  teachings   Teaching[]

  @@map("courses")
}

model Enrollment {
  enrollmentId Int      @id @default(autoincrement()) @map("enrollment_id")
  studentId    Int      @map("student_id")
  courseId     Int      @map("course_id")
  grade        String?  @db.VarChar(5)
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")
  
  student Student @relation(fields: [studentId], references: [studentId], onDelete: Cascade)
  course  Course  @relation(fields: [courseId], references: [courseId], onDelete: Cascade)

  @@unique([studentId, courseId])
  @@map("enrollments")
}

model Teaching {
  teachingId Int      @id @default(autoincrement()) @map("teaching_id")
  facultyId  Int      @map("faculty_id")
  courseId   Int      @map("course_id")
  semester   String   @db.VarChar(20)
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")
  
  faculty Faculty @relation(fields: [facultyId], references: [facultyId], onDelete: Cascade)
  course  Course  @relation(fields: [courseId], references: [courseId], onDelete: Cascade)

  @@unique([facultyId, courseId, semester])
  @@map("teachings")
}
